---
import libraryContent from '../data/library_content.json';

const { currentPage = '' } = Astro.props; // To highlight active link later if needed
---
<aside id="sidebar">
  <h4>Library Navigation</h4>
  <ul>
    <li><a href="/library/" class:list={{ active: currentPage === '/library/' }}>Welcome</a></li>
    
    <li>
      <a href="/library/insights/" class="category-title" class:list={{ active: currentPage.startsWith('/library/insights') && !currentPage.split('/').pop().includes('.') }}>Insights</a>
      {libraryContent.insights && libraryContent.insights.length > 0 && (
        <ul class="submenu">
          {libraryContent.insights.map(item => (
            <li><a href={`/library/insights/${item.slug}`} class:list={{ active: currentPage === `/library/insights/${item.slug}` }}>{item.title}</a></li>
          ))}
        </ul>
      )}
    </li>

    <li>
      <a href="/library/foundations/" class="category-title" class:list={{ active: currentPage.startsWith('/library/foundations') && !currentPage.split('/').pop().includes('.') }}>Foundations</a>
      {libraryContent.foundations && libraryContent.foundations.length > 0 && (
        <ul class="submenu">
          {libraryContent.foundations.map(item => (
            <li><a href={`/library/foundations/${item.slug}`} class:list={{ active: currentPage === `/library/foundations/${item.slug}` }}>{item.title}</a></li>
          ))}
        </ul>
      )}
    </li>

    <li>
      <a href="/library/explorations/" class="category-title" class:list={{ active: currentPage.startsWith('/library/explorations') && !currentPage.split('/').pop().includes('.') }}>Explorations</a>
      {libraryContent.explorations && libraryContent.explorations.length > 0 && (
        <ul class="submenu">
          {libraryContent.explorations.map(item => (
            <li><a href={`/library/explorations/${item.slug}`} class:list={{ active: currentPage === `/library/explorations/${item.slug}` }}>{item.title}</a></li>
          ))}
        </ul>
      )}
    </li>

    <li>
      <a href="/library/masteries/" class="category-title" class:list={{ active: currentPage.startsWith('/library/masteries') && !currentPage.split('/').pop().includes('.') }}>Masteries</a>
      {libraryContent.masteries && libraryContent.masteries.length > 0 && (
        <ul class="submenu">
          {libraryContent.masteries.map(item => (
            <li><a href={`/library/masteries/${item.slug}`} class:list={{ active: currentPage === `/library/masteries/${item.slug}` }}>{item.title}</a></li>
          ))}
        </ul>
      )}
    </li>
  </ul>
</aside>

<style>
  aside {
    background-color: #f0f0f0;
    padding: 0 1rem; /* No top/bottom padding, 1rem left/right */
    width: 280px; /* Adjusted width */
    height: 100%;
    border-right: 1px solid #ddd;
    overflow-y: auto; /* For scrollable sidebar if content exceeds height */
    display: flex; /* Added for better internal content management */
    flex-direction: column; /* Added for better internal content management */
  }
  h4 {
    margin-top: 1.5rem;
    margin-bottom: 1rem;
    font-size: 1.2rem;
  }
  ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  li > a, a.category-title {
    text-decoration: none;
    color: #333;
    display: block;
    padding: 0.6rem 0;
    font-weight: 500;
  }
  li > a:hover {
    color: #007bff;
  }
  li > a.active {
    color: #007bff;
    font-weight: bold;
  }
  a.category-title {
    font-weight: bold;
    color: #555;
    margin-top: 0.5rem;
    padding-left: 0; /* Align with top-level links */
    display: block;
    text-decoration: none;
  }
  a.category-title:hover {
    color: #007bff;
  }
  a.category-title.active {
    color: #007bff;
    font-weight: bold;
  }
  .submenu {
    padding-left: 1rem; /* Indent submenu items */
  }
  .submenu li a {
    padding: 0.4rem 0;
    font-weight: normal;
    font-size: 0.9rem;
  }
  .submenu li a:hover {
    color: #0056b3;
  }
  .submenu li a.active {
    font-weight: 600;
    color: #0056b3;
  }
</style>
